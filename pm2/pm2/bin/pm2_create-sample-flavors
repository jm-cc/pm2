#!/bin/sh

# uncomment this line to have flavor in $PM2_ROOT/flavors
# BEWARE : then, there are some bugs related to flavor dependencies.
# CREATE_FLAGS= -- admin

PM2_CREATE_FLAVOR=${PM2_CREATE_FLAVOR:-${PM2_ROOT}/bin/pm2-flavor}

#if [ -d ${PM2_ROOT}/flavors ]; then
#    rm -rf ${PM2_ROOT}/flavors
#fi

#mkdir -p ${PM2_ROOT}/flavors

$PM2_CREATE_FLAVOR ${CREATE_FLAGS} set --flavor=default \
    --modules="pm2 dsm marcel mad2 tbx ntbx" --all=opt --marcel=mono --mad2=auto_spawn --mad2=tcp

for i in mono smp act actsmp; do
    $PM2_CREATE_FLAVOR ${CREATE_FLAGS} set --flavor=marcel-$i --modules="marcel tbx" \
	--marcel=$i --builddir=marcel-$i --all=opt
done
$PM2_CREATE_FLAVOR ${CREATE_FLAGS} set --flavor=marcel --modules="marcel tbx" --all=opt --marcel=mono

$PM2_CREATE_FLAVOR ${CREATE_FLAGS} set --flavor=swann --modules="swann tbx ntbx" --all=opt
$PM2_CREATE_FLAVOR ${CREATE_FLAGS} set --flavor=leonie --modules="leonie tbx ntbx" --all=opt
$PM2_CREATE_FLAVOR ${CREATE_FLAGS} set --flavor=leoparse --modules="leoparse tbx ntbx" --all=opt
$PM2_CREATE_FLAVOR ${CREATE_FLAGS} set --flavor=mad2 --modules="mad2 tbx ntbx" --all=opt --mad2=auto_spawn --mad2=tcp

$PM2_CREATE_FLAVOR ${CREATE_FLAGS} set --flavor=pm2 --modules="pm2 dsm marcel mad2 tbx ntbx" \
    --all=opt --marcel=mono --mad2=auto_spawn --mad2=tcp

