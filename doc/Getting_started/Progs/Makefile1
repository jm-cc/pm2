## This Makefile should be run with GNU make

ifndef PM2_FLAVOR
$(error PM2_FLAVOR is not yet defined!)
endif

CFLAGS		:= $(shell pm2-config --cflags)
LDFLAGS		:= $(shell pm2-config --libs)
CC		:= $(shell pm2-config --cc)

.PHONY: all clean

CFILES		:= $(wildcard *.c)
OFILES		:= $(CFILES:%.c=%.o)
EXEFILES	:= $(CFILES:%.c=%)

all: ${EXEFILES}

${EXEFILES}: %: %.c
	@echo "Compiling $< for flavor '${PM2_FLAVOR}'..."
	@${CC} ${CFLAGS} $< ${LDFLAGS} -o $@

clean:
	-rm ${EXEFILES} ${OFILES}
