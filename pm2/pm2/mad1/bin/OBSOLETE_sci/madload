#!/bin/sh

if test $# -ge 1 -a $1 = "-debug"
then
    MAD_DEBUG=on
    shift
else
    MAD_DEBUG=off
fi

if test $# -lt 1
then
	echo "Usage: $0 [ -debug ] <execname> [ <arg1> ... <argn> ]"
	exit 1
fi

if test ! -f ${HOME}/.madconf
then
	echo "ERROR: madconf should be runned before $0..."
	exit 1
fi

case $1 in
    /*) command=$* ;;
    *) command=`pwd`/$*
esac

case _$DISPLAY in
    _) DISPLAY=`uname -n`:0.0 ;;
    _:*) DISPLAY=`uname -n`$DISPLAY ;;
    *) ;;
esac

set `cat ${HOME}/.madconf`

if test $MAD_DEBUG = on
then
    exec rsh $1 ${MADELEINE_ROOT}/bin/sci/maddebug "$DISPLAY" $command
else
    exec rsh $1 $command
fi

