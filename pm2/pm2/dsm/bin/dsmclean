#!/bin/sh

if test $# -gt 0
then
    ARCH=$*
else
    ARCH=`cat ${DSM_ROOT}/ARCHITECTURES`
fi

echo Cleaning DSM:
echo
for i in $ARCH
do
	echo $i
	# librairies 
	for f in `ls ${DSM_ROOT}/lib/$i`
	do
	    if [ ! -d ${DSM_ROOT}/lib/$i/$f ] ; then
		echo "	deleting ${DSM_ROOT}/lib/$i/$f"
		rm ${DSM_ROOT}/lib/$i/$f
	    fi
	done
	# objets "source"
	for f in `ls ${DSM_ROOT}/source/obj/$i`
	do
	    if [ ! -d ${DSM_ROOT}/source/obj/$i/$f ] ; then
		echo "	deleting ${DSM_ROOT}/source/obj/$i/$f"
		rm ${DSM_ROOT}/source/obj/$i/$f
	    fi
	done
done
# special
rm -f ${DSM_ROOT}/bin/dsm_page_size
rm -f ${DSM_ROOT}/include/dsm_page_size.h
