#!/bin/sh
###########
#
# Xwindow mode loader

# $1... = command and arguments

prog=$1
shift
args=${@:+"$@"}

title="$prog.${HOST:-`hostname`}"

set `ps -A | grep pm2_logload | sort | sed 's/^[^0-9]*\([0-9]*\).*$/\1 /'`
num='0'

while [ $# -gt 0 ]
do
    [ $$ -eq $1 ] && break
    shift
    num=`expr $num + 1`
done

logfile="/tmp/pm2log-${USER:-nobody}-${num}"

[ -f $logfile ] && rm -f $logfile

echo $title > $logfile

pm2_wrapper $prog $args </dev/null >>$logfile 2>&1
